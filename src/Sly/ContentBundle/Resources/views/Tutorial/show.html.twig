{% extends "SlyCoreBundle:Layout:layout.rightSidebar.html.twig" %}

{% block title %}{{ item }} | {{ 'seo.title' | trans({}, 'tutorial') }}{% endblock title %}
{% block description %}{{ item.excerpt | striptags }}{% endblock description %}

{% block rsidebar %}
    {% include 'SlyContentBundle:Tutorial:rightSidebar.html.twig' %}
{% endblock rsidebar %}

{% block content %}
    <h2>{{ item }}</h2>
    
    <p>
        {% if item.categories | length %}
            {{ 'list.categories' | transchoice(item.categories | length, {}, 'tutorial') }}
        {% else %}
            {{ 'list.nocategory' | trans({}, 'tutorial') }}
        {% endif %}

        {% for k, cat in item.categories %}
            <a href="{{ path('tutorial_category', {'slug': cat.slug}) }}" class="category">{{ cat }}</a>{% if k < (item.categories | length - 1) %},{% endif %}
        {% endfor %}

        -

        {{ 'list.publishedat' | trans({}, 'tutorial') }}
        <abbr title="{{ item.publishedAt | date('Y-m-dTH:i:m') }}" class="dtstart">{{ item.publishedAt | date('Y, M d @ H:i') }}</abbr>
    </p>

    {% if item.tags | length %}
        <p>
            {% for tag in item.tags %}
                <a href="#" class="tag">
                    {{ tag }}
                </a>
            {% endfor %}
        </p>
    {% endif %}
    
    {% if item.link %}
        <p>
            <img src="{{ item.dailyMotionPictureUrl }}" class="picture" alt="{{ item }}" />
        </p>
        
        <p>
            <iframe frameborder="0" width="{{ dmplayer.width }}" height="{{ dmplayer.height }}" src="{{ item.dailyMotionEmbedUrl }}?width={{ dmplayer.width }}"></iframe>
        </p>
    {% endif %}
    
    {% if (item.content | length > 10) %}
        <div class="content_content">
            {{ item.content | raw }}
        </div>
    {% endif %}
    
    <div id="disqus_thread"></div>
{% endblock content %}

{% block javascripts %}
    {{ parent() }}
    
    <script type="text/javascript">
        var disqus_shortname = 'slynett';
        var disqus_identifier = 'tutorial-{{ item.id }}-{{ item.slug }}';
        var disqus_url = '{{ url('tutorial_show', {'slug': item.slug}) }}';
        var disqus_title = '{{ item }}';
    
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
{% endblock javascripts %}